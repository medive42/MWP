wp.media.view.Toolbar.Custom=wp.media.view.Toolbar.extend({initialize:function(){_.defaults(this.options,{event:"custom_event",close:!1,items:{custom_event:{text:metasliderpro.addToSlider,style:"primary",priority:80,requires:!1,click:this.customAction}}}),wp.media.view.Toolbar.prototype.initialize.apply(this,arguments)},refresh:function(){wp.media.view.Toolbar.prototype.refresh.apply(this,arguments)},customAction:function(){var e=this.controller.state().get("selection");e.map(function(e){e=e.toJSON();var t={action:"create_html_overlay_slide",slide_id:e.id,slider_id:window.parent.metaslider_slider_id};jQuery.post(ajaxurl,t,function(e){window.parent.jQuery(".metaslider table#metaslider-slides-list").append(e),window.parent.jQuery(".media-modal-close").click()})})}}),wp.media.view.Custom=wp.media.View.extend({className:"media-custom",events:{input:"custom_update",keyup:"custom_update",change:"custom_update"},initialize:function(){this.input=this.make("input",{type:"text",value:this.model.get("custom_data")}),this.$el.append(this.input),this.model.on("change:custom_data",this.render,this)},render:function(){return this.input.value=this.model.get("custom_data"),this},custom_update:function(e){this.model.set("custom_data",e.target.value)}});var oldMediaFrame=wp.media.view.MediaFrame.Post;wp.media.view.MediaFrame.Post=oldMediaFrame.extend({initialize:function(){oldMediaFrame.prototype.initialize.apply(this,arguments),this.states.add([new wp.media.controller.Library({id:"insert-html",title:wp.media.view.l10n.insertHtmlOverlay,priority:999,toolbar:"add-html-overlay-slide",filterable:"image",library:wp.media.query({type:"image"}),multiple:!1,editable:!0,allowLocalEdits:!0,displaySettings:!0,displayUserSettings:!0})]),this.on("toolbar:create:add-html-overlay-slide",this.createCustomToolbar,this),this.on("toolbar:render:add-html-overlay-slide",this.renderCustomToolbar,this)},createCustomToolbar:function(e){e.view=new wp.media.view.Toolbar.Custom({controller:this})}});