!function(){function e(e,r){return r>=0&&r<e.lineCount()}function r(){U=""}function n(e){U+=e}function i(e){return function(r){F=10*F+e}}function t(){var e=F;return e||1}function o(){F=0}function f(e){for(var r=0,n=t();r<n;++r)e(r,r==n-1);o()}function c(e){return"string"==typeof e&&(e=CodeMirror.commands[e]),function(r){f(function(n,i){e(r,n,i)})}}function u(e,r){for(var n in e)e.hasOwnProperty(n)&&r(n,e[n])}function a(e,r){for(var n=0;n<e.length;++n)r(e[n])}function l(e){return"Shift-"==e.slice(0,6)?e.slice(0,1):"Space"==e?" ":3==e.length&&"'"==e[0]&&"'"==e[2]?e[1]:e.toLowerCase()}function s(e){if(" "==e)return"Space";var r=N.indexOf(e);return r!=-1?"'"+e+"'":e.toLowerCase()==e?e.toUpperCase():"Shift-"+e.toUpperCase()}function p(r,n,i,t,o){for(var f=r.getLine(n);;){for(var c=t>0?f.length:-1,u=c,a=c;i!=c;i+=t)for(var l=0;l<o.length;++l)if(o[l].test(f.charAt(i))){for(u=i;i!=c&&o[l].test(f.charAt(i));i+=t);return a=t>0?i:i+1,{from:Math.min(u,a),to:Math.max(u,a),line:n}}if(n+=t,!e(r,n))return null;f=r.getLine(n),i=t>0?0:f.length}}function d(r,n,i,t,o,f){var c=r.getCursor();f&&(o="start");for(var u=0;u<t;u++)for(var a,l=c.ch,s=c.line;;){if(a=p(r,c.line,c.ch,i,n),!a){for(;e(r,c.line+i);c.line+=i);c.ch=i>0?r.getLine(c.line).length:0;break}if(f&&1==t&&1==i&&c.line!=a.line){c.ch=r.getLine(c.line).length;break}if(c.line=a.line,i>0&&"end"==o){if(l!=a.to-1||s!=a.line){c.ch=a.to-1;break}c.ch=a.to}else if(i>0&&"start"==o){if(l!=a.from||s!=a.line){c.ch=a.from;break}c.ch=a.to}else if(i<0&&"end"==o){if(l!=a.to||s!=a.line){c.ch=a.to;break}c.ch=a.from-1}else if(i<0&&"start"==o){if(l!=a.from||s!=a.line){c.ch=a.from;break}c.ch=a.from-1}}return"end"==o&&f&&c.ch++,c}function h(e){var r=e.getCursor();r.ch,e.getLine(r.line);CodeMirror.commands.goLineEnd(e),r.line!=e.lineCount()&&(CodeMirror.commands.goLineEnd(e),e.replaceSelection(" ","end"),CodeMirror.commands.delCharRight(e))}function m(e,r){var i=B[r];if(void 0!==i){var t=e.getCursor().line,o=i>t?t:i,f=i>t?i:t;e.setCursor(o);for(var c=o;c<=f;c++)n("\n"+e.getLine(o)),e.removeLine(o)}}function v(e,r){var i=B[r];if(void 0!==i){for(var t=e.getCursor().line,o=i>t?t:i,f=i>t?i:t,c=o;c<=f;c++)n("\n"+e.getLine(c));e.setCursor(o)}}function C(e){var r=e.getCursor(),n=e.getLine(r.line).search(/\S/);e.setCursor(r.line,n==-1?line.length:n,!0)}function g(e,r,n){var i,t=e.getCursor(),o=e.getLine(t.line),f=l(r),c=n;return c.forward?(i=o.indexOf(f,t.ch+1),i!=-1&&c.inclusive&&(i+=1)):(i=o.lastIndexOf(f,t.ch),i==-1||c.inclusive||(i+=1)),i}function M(e,r,n){var i=g(e,r,n),t=e.getCursor();i!=-1&&e.setCursor({line:t.line,ch:i})}function y(e,r,n){var i=g(e,r,n),t=e.getCursor();i!==-1&&(n.forward?e.replaceRange("",{line:t.line,ch:t.ch},{line:t.line,ch:i}):e.replaceRange("",{line:t.line,ch:i},{line:t.line,ch:t.ch}))}function x(e){o(),e.setOption("keyMap","vim-insert")}function k(e,r,n,i){e.openDialog?e.openDialog(r,i):i(prompt(n,""))}function L(e,r){var n=r.replace(/[<&]/,function(e){return"<"==e?"&lt;":"&amp;"});e.openDialog?e.openDialog(n+" <button type=button>OK</button>"):alert(r)}function S(e){CodeMirror.keyMap["vim-prefix-m"][e]=function(r){B[e]=r.getCursor().line},CodeMirror.keyMap["vim-prefix-d'"][e]=function(r){m(r,e)},CodeMirror.keyMap["vim-prefix-y'"][e]=function(r){v(r,e)},CodeMirror.keyMap["vim-prefix-r"][e]=function(r){var n=r.getCursor();r.replaceRange(l(e),{line:n.line,ch:n.ch},{line:n.line,ch:n.ch+1}),CodeMirror.commands.goColumnLeft(r)},u(G,function(r,n){CodeMirror.keyMap["vim-prefix-"+r][e]=function(r){M(r,e,n)},CodeMirror.keyMap["vim-prefix-d"+r][e]=function(r){y(r,e,n)},CodeMirror.keyMap["vim-prefix-c"+r][e]=function(r){y(r,e,n),x(r)}})}function O(e,r,n){var i=r.line,n=n?n:e.getLine(i)[r.ch],t=["(","[","{"].indexOf(n)!=-1,o=function(e){switch(e){case"(":return")";case"[":return"]";case"{":return"}";case")":return"(";case"]":return"[";case"}":return"{";default:return null}}(n);if(null==o)return r;for(var f=t?0:1;;){if(i==r.line)var c=t?e.getLine(i).substr(r.ch).split(""):e.getLine(i).substr(0,r.ch).split("").reverse();else var c=t?e.getLine(i).split(""):e.getLine(i).split("").reverse();for(var u=0;u<c.length;u++)if(c[u]==n?f++:c[u]==o&&f--,0==f)return t&&r.line==i?{line:i,ch:u+r.ch}:t?{line:i,ch:u}:{line:i,ch:c.length-u-1};t?i++:i--}}function w(e,r,n){var i=e.getCursor(),t=O(e,i,r),o=O(e,t);return o.ch+=n?1:0,t.ch+=n?0:1,{start:o,end:t}}function R(e,r,n){var i=e.getCursor(),t=e.getLine(i.line),o=t.split(""),f=void 0,c=void 0,u=o.indexOf(r);if(i.ch<u?(i.ch=u,e.setCursor(i.line,u+1)):u<i.ch&&o[i.ch]==r&&(c=i.ch,--i.ch),o[i.ch]==r&&null==c)f=i.ch+1;else for(var a=i.ch;a>-1&&null==f;a--)o[a]==r&&(f=a+1);if(null!=f&&null==c)for(var a=f,l=o.length;a<l&&null==c;a++)o[a]==r&&(c=a);return null==f||null==c?{start:i,end:i}:(n&&(--f,++c),{start:{line:i.line,ch:f},end:{line:i.line,ch:c}})}function b(e,r,n){var i=e.getCursor();return{line:i.line+r,ch:i.ch+n}}function E(e){keyMap=CodeMirror.keyMap[e],keyMap[0]=function(e){F>0?i(0)(e):CodeMirror.commands.goLineStart(e)};for(var r=1;r<10;++r)keyMap[r]=i(r)}function P(e,r,n){for(var i=null==n?e.length:n;i>=0;--i)if(r.test(e.charAt(i)))return i;return-1}function A(e,r,i,t,o){var f=z[r](e,o),c=f.start,u=f.end;if(c.line>u.line||c.line==u.line&&c.ch>u.ch)var a=!0;n(e.getRange(a?u:c,a?c:u)),i&&e.replaceRange("",a?u:c,a?c:u),t&&e.setOption("keyMap","vim-insert")}var D="f",U="",B={},F=0,N="~`!@#$%^&*()_-+=[{}]\\|/?.,<>:;\"'1234567890",I=[/\w/,/[^\w\s]/],T=[/\S/],W=CodeMirror.keyMap.vim={"'|'":function(e){e.setCursor(e.getCursor().line,t()-1,!0),o()},A:function(e){e.setCursor(e.getCursor().line,e.getCursor().ch+1,!0),x(e)},"Shift-A":function(e){CodeMirror.commands.goLineEnd(e),x(e)},I:function(e){x(e)},"Shift-I":function(e){C(e),x(e)},O:function(e){CodeMirror.commands.goLineEnd(e),CodeMirror.commands.newlineAndIndent(e),x(e)},"Shift-O":function(e){CodeMirror.commands.goLineStart(e),e.replaceSelection("\n","start"),e.indentLine(e.getCursor().line),x(e)},G:function(e){e.setOption("keyMap","vim-prefix-g")},"Shift-D":function(e){var i=e.getCursor(),t=i.line,o=e.getLine(t);e.setLine(t,o.slice(0,i.ch)),r(),n(o.slice(i.ch)),F>1&&(--F,++t,f(function(){n(e.getLine(t)),e.removeLine(t)}))},S:function(e){c(function(e){CodeMirror.commands.delCharRight(e)})(e),x(e)},M:function(e){e.setOption("keyMap","vim-prefix-m"),B={}},Y:function(e){e.setOption("keyMap","vim-prefix-y"),r()},"Shift-Y":function(e){r(),f(function(r){n("\n"+e.getLine(e.getCursor().line+r))})},"/":function(e){var r=CodeMirror.commands.find;r&&r(e),D="f"},"'?'":function(e){var r=CodeMirror.commands.find;r&&(r(e),CodeMirror.commands.findPrev(e),D="r")},N:function(e){var r=CodeMirror.commands.findNext;r&&("r"!=D?r(e):CodeMirror.commands.findPrev(e))},"Shift-N":function(e){var r=CodeMirror.commands.findNext;r&&("r"!=D?CodeMirror.commands.findPrev(e):r.findNext(e))},"Shift-G":function(e){0==F?e.setCursor(e.lineCount()):e.setCursor(F-1),o(),CodeMirror.commands.goLineStart(e)},"':'":function(e){var r=': <input type="text" style="width: 90%"/>';k(e,r,":",function(r){r.match(/^\d+$/)?e.setCursor(r-1,e.getCursor().ch):L(e,"Bad command: "+r)})},nofallthrough:!0,style:"fat-cursor"};a(["d","t","T","f","F","c","r"],function(e){CodeMirror.keyMap.vim[s(e)]=function(n){n.setOption("keyMap","vim-prefix-"+e),r()}}),u({X:function(e){CodeMirror.commands.delCharRight(e)},P:function(e){e.getCursor().line;""!=U&&("\n"==U[0]&&CodeMirror.commands.goLineEnd(e),e.replaceRange(U,e.getCursor()))},"Shift-X":function(e){CodeMirror.commands.delCharLeft(e)},"Shift-J":function(e){h(e)},"Shift-P":function(e){var r=e.getCursor().line;""!=U&&(CodeMirror.commands.goLineUp(e),CodeMirror.commands.goLineEnd(e),e.replaceSelection(U,"end")),e.setCursor(r+1)},"'~'":function(e){var r=e.getCursor(),n=e.getRange({line:r.line,ch:r.ch},{line:r.line,ch:r.ch+1});n=n!=n.toLowerCase()?n.toLowerCase():n.toUpperCase(),e.replaceRange(n,{line:r.line,ch:r.ch},{line:r.line,ch:r.ch+1}),e.setCursor(r.line,r.ch+1)},"Ctrl-B":function(e){CodeMirror.commands.goPageUp(e)},"Ctrl-F":function(e){CodeMirror.commands.goPageDown(e)},"Ctrl-P":"goLineUp","Ctrl-N":"goLineDown",U:"undo","Ctrl-R":"redo"},function(e,r){W[e]=c(r)}),a(["vim-prefix-d'","vim-prefix-y'","vim-prefix-df","vim-prefix-dF","vim-prefix-dt","vim-prefix-dT","vim-prefix-c","vim-prefix-cf","vim-prefix-cF","vim-prefix-ct","vim-prefix-cT","vim-prefix-","vim-prefix-f","vim-prefix-F","vim-prefix-t","vim-prefix-T","vim-prefix-r","vim-prefix-m"],function(e){CodeMirror.keyMap[e]={auto:"vim",nofallthrough:!0,style:"fat-cursor"}}),CodeMirror.keyMap["vim-prefix-g"]={E:c(function(e){e.setCursor(d(e,I,-1,1,"end"))}),"Shift-E":c(function(e){e.setCursor(d(e,T,-1,1,"end"))}),G:function(e){e.setCursor({line:F-1,ch:e.getCursor().ch}),o()},auto:"vim",nofallthrough:!0,style:"fat-cursor"},CodeMirror.keyMap["vim-prefix-d"]={D:c(function(e){n("\n"+e.getLine(e.getCursor().line)),e.removeLine(e.getCursor().line),e.setOption("keyMap","vim")}),"'":function(e){e.setOption("keyMap","vim-prefix-d'"),r()},B:function(e){var r=e.getCursor(),i=e.getLine(r.line),t=i.lastIndexOf(" ",r.ch);n(i.substring(t,r.ch)),e.replaceRange("",{line:r.line,ch:t},r),e.setOption("keyMap","vim")},nofallthrough:!0,style:"fat-cursor"},CodeMirror.keyMap["vim-prefix-c"]={B:function(e){c("delWordLeft")(e),x(e)},C:function(e){f(function(r,n){CodeMirror.commands.deleteLine(e),r&&(CodeMirror.commands.delCharRight(e),n&&CodeMirror.commands.deleteLine(e))}),x(e)},nofallthrough:!0,style:"fat-cursor"},a(["vim-prefix-d","vim-prefix-c","vim-prefix-"],function(e){a(["f","F","T","t"],function(n){CodeMirror.keyMap[e][s(n)]=function(i){i.setOption("keyMap",e+n),r()}})});for(var G={t:{inclusive:!1,forward:!0},f:{inclusive:!0,forward:!0},T:{inclusive:!1,forward:!1},F:{inclusive:!0,forward:!1}},Y=65;Y<91;Y++){var $=String.fromCharCode(Y);S(s($)),S(s($.toLowerCase()))}for(var Y=0;Y<N.length;++Y)S(s(N.charAt(Y)));S("Space"),CodeMirror.keyMap["vim-prefix-y"]={Y:c(function(e,r,i){n("\n"+e.getLine(e.getCursor().line+r)),e.setOption("keyMap","vim")}),"'":function(e){e.setOption("keyMap","vim-prefix-y'"),r()},nofallthrough:!0,style:"fat-cursor"},CodeMirror.keyMap["vim-insert"]={Esc:function(e){e.setCursor(e.getCursor().line,e.getCursor().ch-1,!0),e.setOption("keyMap","vim")},"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",fallthrough:["default"]};var J={J:function(e,r){return b(e,r,0)},Down:function(e,r){return b(e,r,0)},K:function(e,r){return b(e,-r,0)},Up:function(e,r){return b(e,-r,0)},L:function(e,r){return b(e,0,r)},Right:function(e,r){return b(e,0,r)},Space:function(e,r){return b(e,0,r)},H:function(e,r){return b(e,0,-r)},Left:function(e,r){return b(e,0,-r)},Backspace:function(e,r){return b(e,0,-r)},B:function(e,r,n){return d(e,I,-1,r,"start",n)},"Shift-B":function(e,r,n){return d(e,T,-1,r,"start",n)},E:function(e,r,n){return d(e,I,1,r,"end",n)},"Shift-E":function(e,r,n){return d(e,T,1,r,"end",n)},W:function(e,r,n){return d(e,I,1,r,"start",n)},"Shift-W":function(e,r,n){return d(e,T,1,r,"start",n)},"'^'":function(e,r){for(var n=e.getCursor(),i=e.getLine(n.line).split(""),t=0;t<i.length;t++)if(i[t].match(/[^\s]/))return{line:n.line,ch:index};return n},"'$'":function(e){var r=e.getCursor(),n=e.getLine(r.line).length;return{line:r.line,ch:n}},"'%'":function(e){return O(e,e.getCursor())},Esc:function(e){return e.setOption("keyMap","vim"),F=0,e.getCursor()}};u(J,function(e,r){CodeMirror.keyMap["vim-prefix-d"][e]=function(e){var i=e.getCursor(),t=r(e,F?F:1,!0);if(i.line>t.line||i.line==t.line&&i.ch>t.ch)var o=!0;n(e.getRange(o?t:i,o?i:t)),e.replaceRange("",o?t:i,o?i:t),F=0,e.setOption("keyMap","vim")},CodeMirror.keyMap["vim-prefix-c"][e]=function(e){var i=e.getCursor(),t=r(e,F?F:1,!0);if(i.line>t.line||i.line==t.line&&i.ch>t.ch)var o=!0;n(e.getRange(o?t:i,o?i:t)),e.replaceRange("",o?t:i,o?i:t),F=0,e.setOption("keyMap","vim-insert")},CodeMirror.keyMap["vim-prefix-y"][e]=function(e){var i=e.getCursor(),t=r(e,F?F:1,!0);if(i.line>t.line||i.line==t.line&&i.ch>t.ch)var o=!0;n(e.getRange(o?t:i,o?i:t)),F=0,e.setOption("keyMap","vim")},CodeMirror.keyMap.vim[e]=function(e){var n=r(e,F?F:1);e.setCursor(n.line,n.ch),F=0}}),E("vim"),E("vim-prefix-d"),E("vim-prefix-y"),E("vim-prefix-c");var K=["d","y","c"];a(K,function(e,r,n){CodeMirror.keyMap["vim-prefix-"+e+"a"]={auto:"vim",nofallthrough:!0,style:"fat-cursor"},CodeMirror.keyMap["vim-prefix-"+e+"i"]={auto:"vim",nofallthrough:!0,style:"fat-cursor"},CodeMirror.keyMap["vim-prefix-"+e].A=function(r){F=0,r.setOption("keyMap","vim-prefix-"+e+"a")},CodeMirror.keyMap["vim-prefix-"+e].I=function(r){F=0,r.setOption("keyMap","vim-prefix-"+e+"i")}});for(var X=["W","Shift-[","Shift-9","[","'","Shift-'"],z={W:function(e,r){var n=e.getCursor(),i=e.getLine(n.line),t=new String(i.substring(0,n.ch)),o=P(t,/[^a-zA-Z0-9]/)+1,f=J.E(e,1);return f.ch+=r?1:0,{start:{line:n.line,ch:o},end:f}},"Shift-[":function(e,r){return w(e,"}",r)},"Shift-9":function(e,r){return w(e,")",r)},"[":function(e,r){return w(e,"]",r)},"'":function(e,r){return R(e,"'",r)},"Shift-'":function(e,r){return R(e,'"',r)}},Y=0;Y<X.length;++Y){var H=X[Y];!function(e){CodeMirror.keyMap["vim-prefix-di"][e]=function(r){A(r,e,!0,!1,!1)},CodeMirror.keyMap["vim-prefix-da"][e]=function(r){A(r,e,!0,!1,!0)},CodeMirror.keyMap["vim-prefix-yi"][e]=function(r){A(r,e,!1,!1,!1)},CodeMirror.keyMap["vim-prefix-ya"][e]=function(r){A(r,e,!1,!1,!0)},CodeMirror.keyMap["vim-prefix-ci"][e]=function(r){A(r,e,!0,!0,!1)},CodeMirror.keyMap["vim-prefix-ca"][e]=function(r){A(r,e,!0,!0,!0)}}(H)}}();